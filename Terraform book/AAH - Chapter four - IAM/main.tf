provider "aws" {
  region = "ca-central-1"
}

resource "aws_iam_user" "myUser" {
  name = "john"
}

resource "aws_iam_policy" "customPolicy" {
  name   = "MyCustomPolicy"
  policy = <<EOF
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor0",
            "Effect": "Allow",
            "Action": [
                "glue:GetCrawler",
                "glue:BatchGetDevEndpoints",
                "glue:GetTableVersions",
                "glue:GetPartitions",
                "glue:GetMLTransform",
                "glue:UpdateCrawler",
                "glacier:ListParts",
                "glue:GetDevEndpoint",
                "glue:UpdateTrigger",
                "glue:GetTrigger",
                "glue:GetJobRun",
                "glacier:PurchaseProvisionedCapacity",
                "glue:GetJobs",
                "glue:DeleteCrawler",
                "glacier:DeleteVault",
                "glue:GetTriggers",
                "glacier:DeleteArchive",
                "glue:GetWorkflowRun",
                "glue:GetMapping",
                "glue:GetPartition",
                "glue:DeleteConnection",
                "glacier:ListMultipartUploads",
                "glue:UseMLTransforms",
                "glacier:SetVaultNotifications",
                "glue:BatchDeleteConnection",
                "glacier:CompleteMultipartUpload",
                "glue:StartCrawlerSchedule",
                "glue:UpdateMLTransform",
                "glacier:ListVaults",
                "glue:CreateMLTransform",
                "glue:GetClassifiers",
                "glacier:CreateVault",
                "glue:StartMLEvaluationTaskRun",
                "glue:BatchDeletePartition",
                "glue:DeleteTableVersion",
                "glue:CreateTrigger",
                "glue:CreateUserDefinedFunction",
                "glue:StopCrawler",
                "glue:StopTrigger",
                "glue:DeleteJob",
                "glacier:DeleteVaultNotifications",
                "glue:GetCatalogImportStatus",
                "glue:DeleteDevEndpoint",
                "glue:DeleteMLTransform",
                "glue:CreateJob",
                "glue:GetTableVersion",
                "glue:GetConnection",
                "glue:ResetJobBookmark",
                "glue:CreatePartition",
                "glue:UpdatePartition",
                "glue:BatchGetPartition",
                "glue:GetTags",
                "glue:StartMLLabelingSetGenerationTaskRun",
                "glue:GetTable",
                "glue:GetDatabase",
                "glue:GetDataflowGraph",
                "glue:BatchGetCrawlers",
                "glue:CreateDatabase",
                "glue:BatchDeleteTableVersion",
                "glue:GetPlan",
                "glue:GetJobRuns",
                "glue:BatchCreatePartition",
                "glue:SearchTables",
                "glacier:AbortMultipartUpload",
                "glue:GetDataCatalogEncryptionSettings",
                "glue:CreateClassifier",
                "glue:GetWorkflowRunProperties",
                "glue:UpdateTable",
                "glue:DeleteTable",
                "glue:DeleteWorkflow",
                "glue:GetSecurityConfiguration",
                "glue:GetResourcePolicy",
                "glue:CreateScript",
                "glue:UpdateWorkflow",
                "glue:GetUserDefinedFunction",
                "glue:StartWorkflowRun",
                "glue:StopCrawlerSchedule",
                "glue:GetUserDefinedFunctions",
                "glue:PutResourcePolicy",
                "glue:GetClassifier",
                "glacier:InitiateJob",
                "glue:UpdateDatabase",
                "glue:GetTables",
                "glue:CreateTable",
                "glue:DeleteResourcePolicy",
                "glacier:ListTagsForVault",
                "glue:BatchStopJobRun",
                "glue:DeleteUserDefinedFunction",
                "glue:CreateConnection",
                "glue:CreateCrawler",
                "glue:DeleteSecurityConfiguration",
                "glue:GetDevEndpoints",
                "glue:BatchGetWorkflows",
                "glue:BatchGetJobs",
                "glue:StartJobRun",
                "glue:BatchDeleteTable",
                "glacier:UploadMultipartPart",
                "glue:UpdateClassifier",
                "glue:CreateWorkflow",
                "glue:DeletePartition",
                "glue:GetJob",
                "glue:GetWorkflow",
                "glue:GetConnections",
                "glue:GetCrawlers",
                "glue:CreateSecurityConfiguration",
                "glue:PutWorkflowRunProperties",
                "glue:DeleteDatabase",
                "glue:StartTrigger",
                "glue:ImportCatalogToGlue",
                "glacier:ListJobs",
                "glue:PutDataCatalogEncryptionSettings",
                "glue:StartCrawler",
                "glacier:InitiateMultipartUpload",
                "glue:UpdateJob",
                "glue:GetJobBookmark",
                "glacier:UploadArchive",
                "glue:StartImportLabelsTaskRun",
                "glue:DeleteClassifier",
                "glue:StartExportLabelsTaskRun",
                "glue:UpdateUserDefinedFunction",
                "glue:CancelMLTaskRun",
                "glue:GetSecurityConfigurations",
                "glue:GetDatabases",
                "glue:GetMLTaskRun",
                "glue:UpdateCrawlerSchedule",
                "glue:UpdateConnection",
                "glue:BatchGetTriggers",
                "glue:CreateDevEndpoint",
                "glue:UpdateDevEndpoint",
                "glue:GetWorkflowRuns",
                "glue:DeleteTrigger",
                "glue:GetCrawlerMetrics",
                "glacier:ListProvisionedCapacity"
            ],
            "Resource": "*"
        }
    ]
}
  EOF
}

resource "aws_iam_user_policy_attachment" "policyBind" {
  user = aws_iam_user.myUser.name
  policy_arn = aws_iam_policy.customPolicy.arn
}